require=function(t){},function(){GM_addStyle("\n    .month-btn {\n      box-shadow:inset 0px 1px 0px 0px #a4e271;\n      background:linear-gradient(to bottom, #89c403 5%, #77a809 100%);\n      background-color:#89c403;\n      border-radius:6px;\n      border:1px solid #74b807;\n      display:inline-block;\n      cursor:pointer;\n      color:#ffffff;\n      font-family:Arial;\n      font-size:15px;\n      font-weight:bold;\n      padding:6px 24px;\n      text-decoration:none;\n      text-shadow:0px 1px 0px #528009;\n    }\n    .month-btn:hover {\n      background:linear-gradient(to bottom, #77a809 5%, #89c403 100%);\n      background-color:#77a809;\n    }\n    .month-btn:active {\n      position:relative;\n      top:1px;\n    }\n    \n    "),GM_addStyle('#overlay-plugin{position:fixed;background:rgba(0,0,0,0.8);width:100%;height:100%;top:0;left:0;z-index:10;display:flex;flex-direction:row;justify-content:center;align-items:center;color:#777;text-align:center;font-family:"Gill sans", sans-serif}#overlay-plugin #modal{margin:auto;position:absolute;background:#ffffff;z-index:2;border-radius:10px;padding:2%}#overlay-plugin h1{margin:1em 0;border-bottom:1px dashed;padding-bottom:1em;font-weight:lighter}#overlay-plugin p{font-style:italic}#overlay-plugin .loader{margin:0 0 2em;height:100px;width:20%;text-align:center;padding:1em;margin:0 auto 1em;display:inline-block;vertical-align:top}.hide{display:none !important}svg path,svg rect{fill:#FF6700}'),GM_addStyle("\n      .modal {\n        position: fixed;\n        left: 0;\n        top: 0;\n        width: 100%;\n        height: 100%;\n        background-color: rgba(0, 0, 0, 0.5);\n        opacity: 0;\n        visibility: hidden;\n        transform: scale(1.1);\n        transition: visibility 0s linear 0.25s, opacity 0.25s 0s, transform 0.25s;\n      }\n      .modal-content {\n          position: absolute;\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n          background-color: white;\n          padding: 1rem 1.5rem;\n          width: 24rem;\n          border-radius: 0.5rem;\n      }\n      .close-button {\n          float: right;\n          width: 1.5rem;\n          line-height: 1.5rem;\n          text-align: center;\n          cursor: pointer;\n          border-radius: 0.25rem;\n          background-color: lightgray;\n      }\n      .close-button:hover {\n          background-color: darkgray;\n      }\n      .show-modal {\n          opacity: 1;\n          visibility: visible;\n          transform: scale(1.0);\n          transition: visibility 0s linear 0s, opacity 0.25s 0s, transform 0.25s;\n      }  \n    ")}(),ConfirmationModalTemplate=function(){var t=document.createElement("div");t.classList.add("modal"),t.innerHTML='\n        <div class="modal-content">\n            <span class="close-button">×</span>\n            <h3>Deseja atualizar os dados?</h3>\n            <br /><br />\n            <input type="button" value="Sim" id="comfirm-yes" /> <input type="button" id="comfirm-no" value="Não, use da busca anterior" /> \n        </div>\n    ',document.querySelector("body").appendChild(t),t.querySelector(".close-button").addEventListener("click",function(){t.classList.remove("show-modal")});var e=t.querySelector("#comfirm-yes"),n=t.querySelector("#comfirm-no");return{toggle:function(){return t.classList.toggle("show-modal")},comfirmInput:e,notComfirmInput:n}}();var LoaderTemplate=function(){var t=document.createElement("div");return t.setAttribute("id","overlay-plugin"),t.classList.add("hide"),t.innerHTML='\n            <div id="modal">\n                <div id="header">\n                    <h1>Aguarde um minuto</h1>\n                </div>\n                <div id="body">\n                    <p>Estamos carregando os dados</p>\n                </div>\n                <div class="loader loader--style4" title="3">\n                  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n                     width="24px" height="24px" viewBox="0 0 24 24" style="enable-background:new 0 0 50 50;" xml:space="preserve">\n                    <rect x="0" y="0" width="4" height="7" fill="#333">\n                      <animateTransform  attributeType="xml"\n                        attributeName="transform" type="scale"\n                        values="1,1; 1,3; 1,1"\n                        begin="0s" dur="0.6s" repeatCount="indefinite" />\n                    </rect>\n                    <rect x="10" y="0" width="4" height="7" fill="#333">\n                      <animateTransform  attributeType="xml"\n                        attributeName="transform" type="scale"\n                        values="1,1; 1,3; 1,1"\n                        begin="0.2s" dur="0.6s" repeatCount="indefinite" />\n                    </rect>\n                    <rect x="20" y="0" width="4" height="7" fill="#333">\n                      <animateTransform  attributeType="xml"\n                        attributeName="transform" type="scale"\n                        values="1,1; 1,3; 1,1"\n                        begin="0.4s" dur="0.6s" repeatCount="indefinite" />\n                    </rect>\n                  </svg>\n                </div>\n            </div>',document.querySelector("body").appendChild(t),{hide:function(){t.classList.add("hide")},show:function(){t.classList.remove("hide")}}}(),getMonth=function(t){return 0==t?11:t-1};Date.prototype.minusDay=function(){this.setDate(this.getDate()-1)},Date.prototype.withMonth=function(t){return this.setMonth(getMonth(t)),this},Date.prototype.withDay=function(t){return this.setDate(t),this},Date.prototype.adjustYear=function(t){return(new Date).getMonth()<getMonth(t)&&this.setFullYear(this.getFullYear()-1),this},require("core-js/modules/es6.array.sort"),require("core-js/modules/es6.regexp.replace");var PeriodManager=function(){Period=function(t,e,n){this.id=t,this.start=e,this.end=n};var t=[],e=function(t){return t.replace(/[\s\S]*(\d{2})\/(\d{2})\/(\d{4})[\s\S]*\d{2}\/\d{2}\/\d{4}/,"$2-$1-$3")},n=function(t){return t.replace(/[\s\S]*\d{2}\/\d{2}\/\d{4}[\s\S]*(\d{2})\/(\d{2})\/(\d{4})/,"$2-$1-$3")},o=function(e){for(i=0;i<t.length;i++)if(t[i].start<=e&&e<=t[i].end)return t[i].id;return t[0].id};return function(){if(periodSelect=document.querySelector(".separatorPeriodo + div select"),periodSelect){for(i=0;i<periodSelect.length;i++){var o=periodSelect.options[i],r=o.value,a=o.textContent.trim(),c=new Date(e(a)),l=new Date(n(a));t.push(new Period(r,c,l))}t.sort(function(t,e){return e.id-t.id})}}(),{getPeriod:o}}();require("core-js/modules/es6.regexp.split");var evaluatorHoliday=function(){var t=function(t){if(!localStorage.getItem("holidays")){var e=(new Date).getFullYear(),n="https://raw.githubusercontent.com/erickLFLopes/mentoringSemanal/master/holidays/"+e+".json",o=new XMLHttpRequest;o.onreadystatechange=function(){if(4==this.readyState&&200==this.status){for(var e=JSON.parse(this.responseText),n=[],o=0;o<e.length;o++)n.push(e[o].date);localStorage.setItem("holidays",n),t&&t()}},o.open("GET",n,!0),o.send()}},e=function(){for(var t=localStorage.getItem("holidays").split(","),e=[],n=t.length-1;n>=0;n--){var o=t[n].split("/");e.push(new Date(o[2],--o[1],o[0]))}return e},n=function(t){for(var n=e(),o=n.length-1;o>=0;o--)if(t-n[o]==0)return!0;return!1};return function(){var e=(new Date).getUTCFullYear();localStorage.getItem("holidaysYear")&&localStorage.getItem("holidaysYear")==e||(localStorage.setItem("holidaysYear",e),localStorage.removeItem("holidays")),t()}(),function(){localStorage.getItem("holidays")||t()}(),{getHolidays:e,verifyDate:n}}();require("core-js/modules/es6.regexp.replace");var PDF=function(){function t(){var t=n.template,e=n.templateData;for(var o in e){var r="{{"+o+"}}";t=t.replace(r,e[o])}var a=window.open("","","height="+n.widthWindow+",width="+n.heightWindow);a?(a.document.write(t),a.print(),a.document.close()):GM_notification("Erro ao criar PDF","Click novamente no botão e cancele a busca")}function e(t,e,o){n.changeTemplate("style",t),n.changeTemplate("title",e),n.changeTemplate("data",o)}var n={heightWindow:700,widthWindow:700,template:"\n            <html>\n                <head>\n                    <style>\n                        {{style}}  \n                    </style>\n                    <title>{{title}}</title>\n                </head>\n                <body>\n                    {{data}}\n                </body>\n            </html>",templateData:{style:"",title:"",data:""},setWidthWindow:function(t){this.widthWindow=t|this.widthWindow},setHeightWindow:function(t){this.heightWindow=t|this.heightWindow},changeTemplate:function(t,e){this.templateData[t]=e}};return{generate:e,print:t,configs:n}}();require("core-js/modules/es6.regexp.split"),require("core-js/modules/es6.regexp.replace"),periodUtils=function(){var t=document.querySelectorAll("select[name=per] option"),e=Array.prototype.slice.call(t),n=function(t){return new Date(t.replace(/(\d{2})\/(\d{2})\/(\d{4})/,"$2-$1-$3"))},o=function(t){return{dates:t.text.replace(/[\s\S]*(\d{2}\/\d{2}\/\d{4})[\s\S]*(\d{2}\/\d{2}\/\d{4})[\s\S]*/g,"$1;$2").split(";"),value:t.value}},r=function(t){return{init:n(t.dates[0]),end:n(t.dates[1]+"  23:59:59"),value:t.value}},a=e.map(o).map(r),i=function(t,e){if(!t)return e;var n=a.filter(function(e){return e.init<=t&&t<=e.end});return n.length>0?n[0].value:e||c},c=i(new Date);return{getPeriod:i}}();var cronosUtil=function(){var t=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],e=["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sabado"],n=(new Date).getMonth(),o=n+1,r=o>0?o-1:11,a=r>0?r-1:11;return{getMonthName:function(e){return t[e>0?e-1:11]},getDayName:function(t){return e[t]},getCurrentMonth:function(){return o},getLastMonth:function(){return r},getTwiceLastMonth:function(){return a},getWeekNeedTime:function(t){return 528*t},getInitialWeek:function(t){return t==o?0:4*(o-(t+1))+parseInt((new Date).getDate()/7)}}}(),viewManager=function(){var t=function(t){return'\n            <input id="Month-'.concat(t,'" style="margin-rigth:1%;" type="button" value="Gerar relatório de ').concat(cronosUtil.getMonthName(t),'" />\n        ')},e='<div class="marginTop20" style="overflow:hidden; background-color: #E1E0E0; border: 2px solid #E1E0E0;-moz-border-radius: 4px;-webkit-border-radius: 4px;border-radius: 4px;margin-bottom: 10px;">\n            <div style="float:left;width:2%;background-color:#E1E0E0;padding-top:5px;text-align:center">\n            <i class="fa fa-pencil"></i>\n            </div>\n            <div style="float:left;  width:98%; background-color:#fff">        <div style="padding: 10px">\n                <br>\n                '.concat(t(cronosUtil.getTwiceLastMonth()),"\n                ").concat(t(cronosUtil.getLastMonth()),"\n                ").concat(t(cronosUtil.getCurrentMonth()),"\n                </div>\n                </div>\n            \n    </div></div>");return document.querySelector(".PageTitle +div").insertAdjacentHTML("beforeBegin",e),{btnCurrentMonth:document.querySelector("#Month-"+cronosUtil.getCurrentMonth()),btnLastMonth:document.querySelector("#Month-"+cronosUtil.getLastMonth()),btnTwiceLastMonth:document.querySelector("#Month-"+cronosUtil.getTwiceLastMonth()),monthAccumulation:document.querySelector("#month-acc-"+cronosUtil.getCurrentMonth()),lastMonthAccumulation:document.querySelector("#month-acc-"+cronosUtil.getLastMonth())}}();require("core-js/modules/es6.array.sort"),require("core-js/modules/es6.regexp.replace");var search=function(t,e,n){"use strict";var o=function(t){return("0"+t).slice(-2)},r=function(t){return o(t.getHours())+":"+o(t.getMinutes())},a=function(t){return 528*t},i=((new Date).getMonth(),function(t){return t.querySelector(".TimeINVisualizacao")?t.querySelector(".TimeINVisualizacao").textContent:""}),c=function(t){return t.querySelector(".TimeOUTVisualizacao")?t.querySelector(".TimeOUTVisualizacao").textContent:""},l=function(t){return t.querySelectorAll(".TimeINVisualizacao")[1]?t.querySelectorAll(".TimeINVisualizacao")[1].textContent:""},s=function(t){return t.querySelectorAll(".TimeOUTVisualizacao")[1]?t.querySelectorAll(".TimeOUTVisualizacao")[1].textContent:""},d=function(t){return t.querySelectorAll("input")[5]?t.querySelectorAll("input")[5].value:""},u=function(t,e){var n=60*t.getHours()+t.getMinutes(),o=60*e.getHours()+e.getMinutes(),r=o-n;return r>0?r:0},h=function(t){var e=d(t).replace(/(\d{2})_(\d{2})_(\d{4})/,"$2/$1/$3"),n=new Date(e+" "+i(t)),o=new Date(e+" "+c(t)),a=new Date(e+" "+l(t)),h=new Date(e+" "+s(t));u(n,o),u(a,h),u(n,o),u(a,h);return{day:e.replace(/\d{2}\/(\d{2})\/\d{4}/,"$1"),month:e.replace(/(\d{2})\/\d{2}\/\d{4}/,"$1"),formatedEN:e.replace(/(\d{2})\/(\d{2})\/(\d{4})/,"$3-$1-$2"),formatedPT:e.replace(/(\d{2})\/(\d{2})\/(\d{4})/,"$2/$1/$3"),date:e,start:n,isHoliday:evaluatorHoliday.verifyDate(n),countableDay:!1,dayOfWeek:n.getDay(),s:r(n),e:r(o),s1:r(a),e1:r(h),accumulation:u(n,o)+u(a,h)}},m=function(t,e){for(var n=[],o=$(t).find(".DiaApontamento"),r=0;r<o.length;r++){var a=h(o[r]);a.month==e&&n.push(a)}return n},f=function(t,e){for(var n=0;n<t.length;n++)if(t[n]&&t[n].day&&1*t[n].day==1&&t[n].month&&1*t[n].month==e)return!0;return!1},g=function(t){for(var e=0,n=0;n<t.length;n++)t[n]&&t[n].accumulation&&1*t[n].accumulation>0&&(e+=1*t[n].accumulation);return{accumulation:e,hour:parseInt(e/60),min:e%60}},p=function(t){for(var e=[],n=0;n<t.length;n++)for(var o=0;o<t[n].length;o++)e.push(t[n][o]);for(var r=0,i=0,n=0;n<e.length;n++)e[n]&&e[n].accumulation&&(r+=1*e[n].accumulation),e[n]&&e[n].countableDay&&(i+=1);var c=a(i),l=r-c;return{accumulation:r,hour:parseInt(r/60),min:r%60,needed:c,neededHour:parseInt(c/60),neededMin:c%60,saldo:l,saldoHour:Math.abs(parseInt(l/60)),saldoMin:Math.abs(l%60)}};return{searchDaysFromWeek:function t(o,r,a,i,c){n.show(),dtoPessoaApontamentos.Week=r,dtoPessoaApontamentos.IdPeriodo=o;var l=[];$.ajax({complete:function(){retrivingPonto=0},url:"/Dimep/Ponto/BuscarApontamentos",type:"POST",contentType:"application/json; charset=utf-8",dataType:"html",data:JSON.stringify(dtoPessoaApontamentos),success:function(n){var c=n.replace(/\<scrip[\s\S]*?\<\/script\>/gi,"");if(l=l.concat(m(c,a)),f(l,a))i({week:l,final:!0});else{if(l.length>0){l.sort(function(t,e){return e.day-t.day});var s=new Date(l[0].start);s.minusDay();var d=e.getPeriod(s);o!=d&&(r=1),o=d}t(o,r-1,a,i),i({week:l,final:!1})}},error:function(t,e,n){t.responseText.indexOf("/Account/LogOn")>=0&&t.responseText.indexOf(".indexOf('/Account/LogOn')")<0&&location.reload()}})},getAccumulationWeek:g,getAccumulation:p}}(window,PeriodManager,LoaderTemplate);require("core-js/modules/es6.array.sort"),formatNumber=function(t){return("0"+t).slice(-2)},getHour=function(t){return formatNumber(parseInt(t/60))+"h "+formatNumber(t%60)+"min"},getFormatedTr=function(t,e){return'<tr style="background-color:'.concat(e,';">\n            <td>').concat(cronosUtil.getDayName(t.dayOfWeek),"</td>\n            <td>").concat(t.formatedPT,"</td><td>").concat(t.s,"</td>\n            <td>").concat(t.e,"</td><td>").concat(t.s1,"</td>\n            <td>").concat(t.e1,"</td><td>").concat(getHour(t.accumulation),"</td></tr>")},getDefaultTr=function(t,e){return'<tr style="background-color:'.concat(e,';">\n            <td>').concat(cronosUtil.getDayName(t.dayOfWeek),"</td>\n            <td>").concat(t.formatedPT,"</td><td>-</td>\n            <td>-</td><td>-</td>\n            <td>-</td><td>-</td></tr>")},getColor=function(t,e){return t<e?"red":"#0bb50bd4"},getWeekReport=function(t){var e=t[0],n=t[t.length-1],o=0,r='<table border="1" style="border-collapse: collapse;">\n        <tr><th colspan="7">Semana de '.concat(e.formatedPT," à ").concat(n.formatedPT,"</th></tr>\n        <tr>\n            <th>dia da semana</th>\n            <th>dia do mês</th>\n            <th>Entrada</th>\n            <th>Saída para Almoço</th>\n            <th>Retorno do Almoço</th>\n            <th>Saída</th>\n            <th>Total</th>\n        </tr>"),a=0;t.forEach(function(t){var e=t.isHoliday?"#ff980073":"#fff";0==t.accumulation?r+=getDefaultTr(t,e):(o+=t.accumulation,r+=getFormatedTr(t,e)),t.countableDay&&a++});var i=cronosUtil.getWeekNeedTime(a);return r+='<tr>\n                <td colspan="6"> Tempo necessário: '.concat(getHour(i)," </td>\n                <td style='color:").concat(getColor(o,i),";'>").concat(getHour(o),"</td>\n            </tr></table><br><br>")},isHoliday=function(t){return t.isHoliday},isWeekEndDay=function(t){return 0==t.dayOfWeek||6==t.dayOfWeek},isWeekDay=function(t){return!isWeekEndDay(t)},isValidWeek=function(t){for(var e=0;e<t.length;e++){var n=t[e];if(isWeekDay(n)&&n.accumulation>0)return!0}return!1},processCountablesDays=function(t){t.forEach(function(t){isWeekDay(t)&&!isHoliday(t)&&(t.countableDay=!0)})},getMonthData=function(t,e,n){if(!n)return void e(t,JSON.parse(localStorage.getItem("mes-".concat(t))));var o=[],r=[],a=function(n){if(n.week.length>0&&(processCountablesDays(n.week),r=r.concat(n.week)),n.final){var a=[];r.sort(function(t,e){return t.day-e.day}).forEach(function(t){a.push(t),0!=t.dayOfWeek&&t!=r[r.length-1]||(isValidWeek(a)&&o.push(a),a=[])}),localStorage.setItem("mes-".concat(t),JSON.stringify(o)),e(t,o)}},i=(cronosUtil.getInitialWeek(t),PeriodManager.getPeriod((new Date).withMonth(t).withDay(28).adjustYear(t)));search.searchDaysFromWeek(i,0,t,a,null)};var month=(new Date).getMonth()+1,lastMonth=1==month?12:month-1,twiceLastMonth=1==lastMonth?12:lastMonth-1;buildMonthReport=function(t,e){var n="<center><h1>Mês ".concat(cronosUtil.getMonthName(t),"</h1>");return e.forEach(function(t){n+=getWeekReport(t)}),n+"</center>"},enableBtn=function(t){return t.disabled=!1},changeByPlusButton=function(t){return t.classList.add("PlusButton")},processButton=function(t){enableBtn(t),changeByPlusButton(t)},buildButton=function(t,e,n){t.addEventListener("click",function(t,e){PDF.generate("","Relatório de ".concat(cronosUtil.getMonthName(t)),e),PDF.print()})},processMonthInfo=function(t,e){var n=search.getAccumulation(e);t.innerHTML=(n.saldo<0?"-":"+")+n.saldoHour+"h e "+n.saldoMin+"min",t.style.color=n.saldo<0?"red":"green"},reportMonth=month,generateReportClick=function(t){ConfirmationModalTemplate.toggle(),t?generateReport():generateLocalReport()},generateReport=function(){LoaderTemplate.show(),getMonthData(reportMonth,function(t,e){PDF.generate("","Relatório de ".concat(cronosUtil.getMonthName(t)),buildMonthReport(t,e)),LoaderTemplate.hide(),PDF.print()},!0)},generateLocalReport=function(){getMonthData(reportMonth,function(t,e){PDF.generate("","Relatório de ".concat(cronosUtil.getMonthName(t)),buildMonthReport(t,e)),PDF.print()},!1)},validateLocalData=function(){return void 0!=localStorage.getItem("mes-".concat(month))&&"null"!=localStorage.getItem("mes-".concat(month))},ConfirmationModalTemplate.comfirmInput.addEventListener("click",function(){return generateReportClick(!0)}),ConfirmationModalTemplate.notComfirmInput.addEventListener("click",function(){return generateReportClick(!1)});var btn=viewManager.btnCurrentMonth;btn.addEventListener("click",function(){reportMonth=month,validateLocalData?ConfirmationModalTemplate.toggle():generateReport()});var btnLastMonth=viewManager.btnLastMonth;btnLastMonth.addEventListener("click",function(){reportMonth=lastMonth,validateLocalData?ConfirmationModalTemplate.toggle():generateReport()});var btnTwiceLastMonth=viewManager.btnTwiceLastMonth;btnTwiceLastMonth.addEventListener("click",function(){reportMonth=twiceLastMonth,validateLocalData?ConfirmationModalTemplate.toggle():generateReport()});